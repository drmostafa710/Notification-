<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>

  <body>
    <div class="message"></div>

    <button class="send">Send</button>

    <script type="module">
      // https://firebase.google.com/docs/web/setup#available-libraries

      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-app.js";

      import {
        getMessaging,
        getToken,
        onMessage,
      } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-messaging.js";

      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBqzGlq5Qukfk1WKzRCl9L8ndH2FnAct7k",
        authDomain: "qzapp-3db60.firebaseapp.com",
        projectId: "qzapp-3db60",
        storageBucket: "qzapp-3db60.appspot.com",
        messagingSenderId: "512223543409",
        appId: "1:512223543409:web:8167a582ef6f5a37661bd0",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const messaging = getMessaging(app);

      Notification.requestPermission().then((permission) => {
        if (permission === "granted") {
          navigator.serviceWorker
            .register("Notification-//sw.js", { type: 'module' })
            .then((register) => {
              getToken(messaging, {
                serviceWorkerRegistration: register,
                vapidKey:
                  "BBajxOpkkdCoOO8ezHTIUx6QIpu5sk3WbiUCNkio1l520waR5KEgYuHa01vyzDl0fbq3rIi3gy6fqt4QF5zbkSI",
              })
                .then((currentToken) => {
                  if (currentToken) {
                    console.log("Token:", currentToken);
                    const tokenElement = document.createElement("p");
                    tokenElement.textContent = currentToken;
                    document.body.appendChild(tokenElement);
                  } else {
                    console.log("No token available.");
                  }
                })
                .catch((err) => {
                  console.error(
                    "Token retrieval failed:",
                    err.code,
                    err.message
                  );
                });
            });
        } else {
          console.log("Permission denied.");
        }
      });
    </script>

  </body>
</html>
